name: CI run

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build:
    runs-on: ubuntu-20.04
    timeout-minutes: 30
    steps:
    - uses: actions/checkout@v2

    - name: update packages
      run: sudo apt update

    # set up verilog & verilator
    #    - name  install haskell 
    #      uses: V0XNIHILI/install-verilator-action@main

    # set up haskell
    - name: install haskell 
      run: sudo apt install haskell-platform

    # set up tinygrad
    - name: install tinygrad
      run: pip install tinygrad

    - name: test rust (not sure if rustc is installed by default)
      run: rustc ./rust/2022/day_1/src/main.rs

    - name: Testbench Tinygrad
      run: |
          days=("day1" "day2")
          cd tinygrad/2022
          for day in ${days[@]}; do
            time python tiny.py $day
          done
