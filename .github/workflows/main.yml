name: CI run

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]




# ADD JOBS, VERILATOR, C
    # set up verilog & verilator
    #    - name  install haskell 
    #      uses: V0XNIHILI/install-verilator-action@main

jobs:
  haskell:
    runs-on: ubuntu-20.04
    timeout-minutes: 30

    steps:
    - uses: actions/checkout@v4

    - name: update packages
      run: sudo apt update

    # set up haskell
    - name: install haskell
      run: sudo apt install haskell-platform cabal-install

    - name: install deps
      run: |
          cabal update
          cabal install --lib process hspec split

    - name: Testbench haskell 2022
      run: |
          days=("day1" "day2" "day3" "day4" "day5" "day6" "day7" "day8" "day9")
          cd haskell/2022
          ghc haskell.hs
          for day in ${days[@]}; do
            haskell $day
            time ./$day/lib
          done

  tinygrad:
    runs-on: ubuntu-20.04
    timeout-minutes: 30

    steps:
    - uses: actions/checkout@v4

    - name: update packages
      run: sudo apt update

    # set up tinygrad
    - name: install tinygrad
      run: pip install tinygrad

    - name: Testbench Tinygrad 2022
      run: |
          days=("day1" "day2")
          cd tinygrad/2022
          for day in ${days[@]}; do
            time python tiny.py $day;
          done
